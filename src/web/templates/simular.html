<!doctype html><html><body>
<h2>Simulación</h2>
<form method="post">
Invernadero:
<select name="inv">
  {% for n in inv_names %}
    <option value="{{ n }}" {% if inv.nombre()==n %}selected{% endif %}>{{ n }}</option>
  {% endfor %}
</select>
Plan:
<select name="plan">
  {% for n in plan_names %}
    <option value="{{ n }}" {% if plan.nombre()==n %}selected{% endif %}>{{ n }}</option>
  {% endfor %}
</select>
<button name="accion" value="run" type="submit">Simular</button>
</form>

{% if res %}
<p><b>Tiempo óptimo:</b> {{ res.tiempo }} s | <b>Agua:</b> {{ res.total_litros }} L | <b>Fertilizante:</b> {{ res.total_gramos }} g</p>
<table border="1" cellpadding="4">
<tr><th>Segundo</th>{% for dr in inv.drones() %}<th>{{ dr.nombre() }}</th>{% endfor %}</tr>
{% for seg in res.timeline %}
<tr><td>{{ seg.t }}</td>
{% for dr in inv.drones() %}
  {% set accion = '' %}
  {% for a in seg.acciones %}
    {% if a.dron == dr.nombre() %}{% set accion = a.accion %}{% endif %}
  {% endfor %}
  <td>{{ accion }}</td>
{% endfor %}
</tr>
{% endfor %}
</table>
<p><a href="{{ url_for('descargar_xml') }}">Descargar salida.xml</a> | <a href="{{ url_for('reporte') }}">Ver Reporte HTML</a></p>

<form method="post" action="{{ url_for('grafo_tda') }}">
  <label>t (segundos): <input type="number" name="t" min="1" value="1"></label>
  <button type="submit">Generar Grafo TDA</button>
</form>
{% endif %}

</body></html>
